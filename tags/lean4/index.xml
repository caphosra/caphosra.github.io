<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Lean4 on caphosra note</title><link>https://caphosra.net/tags/lean4/</link><description>Recent content in Lean4 on caphosra note</description><generator>Hugo</generator><language>ja</language><lastBuildDate>Wed, 13 Aug 2025 12:40:28 +0900</lastBuildDate><atom:link href="https://caphosra.net/tags/lean4/index.xml" rel="self" type="application/rss+xml"/><item><title>[Lean4] 実数を構成する</title><link>https://caphosra.net/posts/2025-08-10-lean4-real/</link><pubDate>Sun, 10 Aug 2025 15:05:14 +0900</pubDate><guid>https://caphosra.net/posts/2025-08-10-lean4-real/</guid><description>&lt;script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">&lt;/script>
&lt;p>Lean4を使って有理数を構成してから実数を構成し、任意の有理数に対してそれに対応する実数の構成が確かにできることを示した。その過程をまとめたい。&lt;/p>
&lt;h2 id="構成と証明したことの概要">
 構成と証明したことの概要
 &lt;a class="heading-link" href="#%e6%a7%8b%e6%88%90%e3%81%a8%e8%a8%bc%e6%98%8e%e3%81%97%e3%81%9f%e3%81%93%e3%81%a8%e3%81%ae%e6%a6%82%e8%a6%81">
 &lt;i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク">&lt;/i>
 &lt;span class="sr-only">見出しへのリンク&lt;/span>
 &lt;/a>
&lt;/h2>
&lt;p>まず前提として、Lean4の標準ライブラリにある、自然数を表現する&lt;code>Nat&lt;/code>, 整数を表現する&lt;code>Int&lt;/code>とそれに関する諸定理は断りなく使った。&lt;/p>
&lt;p>その上で、整数と自然数の組\(\mathbb{Z}\times \mathbb{N}_{&amp;gt;0}\)(&lt;code>NumPair&lt;/code>と命名)を定義し、これに対して、適当な同値関係\(\sim\)を定義した。この同値関係は、\((a, b) \sim (c, d) \Leftrightarrow ad = cb\)となるようなもので、整数の方を分子、自然数の方を分母とみなした時の分数のよくある同値関係を意味している。&lt;/p>
&lt;p>次に、上記の同値関係を用いて、同値類\(\mathbb{Z}\times\mathbb{N}_{&amp;gt;0}/\sim\)をとり、その元を有理数&lt;code>Rational&lt;/code>とした。&lt;/p>
&lt;p>最後に、&lt;code>Rational&lt;/code>の集合を用いて、Dedekind cutをとり実数&lt;code>Real&lt;/code>を構成した。&lt;/p>
&lt;p>証明については、任意の有理数\(r\)について\(\{x \in \mathbb{Q}|x &amp;lt; r \}\)が、確かに実数の元となっていることを示した。この証明に際して\(\mathbb{Q}\)が稠密であることを示した。&lt;/p>
&lt;h2 id="設けた縛り">
 設けた縛り
 &lt;a class="heading-link" href="#%e8%a8%ad%e3%81%91%e3%81%9f%e7%b8%9b%e3%82%8a">
 &lt;i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク">&lt;/i>
 &lt;span class="sr-only">見出しへのリンク&lt;/span>
 &lt;/a>
&lt;/h2>
&lt;p>今回、この構成と証明をするにあたって、個人的に以下の縛りを設けた。&lt;/p>
&lt;ol>
&lt;li>証明は&lt;strong>排中律を使わずに&lt;/strong>行う。&lt;/li>
&lt;li>&lt;strong>Mathlibは使わない。&lt;/strong>&lt;/li>
&lt;/ol>
&lt;p>まず、排中律を使わなかったことについて。今回は、構成的な証明にすることを目標としたので、排中律ならびにそれと同値の公理を利用しなかった。これにより、二重否定除去や背理法による証明ができなくなったが、今回の場合はなんとかなった。&lt;/p>
&lt;p>次に、&lt;a href="https://github.com/leanprover-community/mathlib4" class="external-link" target="_blank" rel="noopener">Mathlib&lt;/a>を使わないことについて。理由は主に2つある。1つはMathlibにはさまざまな有用な定理が収録されており、あまりにも便利すぎるから。そして、Mathlibのライブラリには背理法を行うtactic &lt;code>by_contra&lt;/code>を用いた証明がかなり収録されていたはず&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>なので、意図しないうちに前述のルールを破ってしまう可能性があるからである。&lt;/p>
&lt;p>ちなみにMathlibでは&lt;code>Mathlib.Data.Real.Basic&lt;/code>において実数を表現する&lt;code>Real&lt;/code>が定義されており、これはCauchy列を用いて定義されている。&lt;/p>
&lt;h2 id="1-有理数の構成">
 1. 有理数の構成
 &lt;a class="heading-link" href="#1-%e6%9c%89%e7%90%86%e6%95%b0%e3%81%ae%e6%a7%8b%e6%88%90">
 &lt;i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク">&lt;/i>
 &lt;span class="sr-only">見出しへのリンク&lt;/span>
 &lt;/a>
&lt;/h2>
&lt;p>前置きはこれくらいにして、実際に実数を構成した過程を見ていく。&lt;/p>
&lt;p>まず、有理数を構成するために、整数と自然数の組\(\mathbb{Z}\times \mathbb{N}_{&amp;gt;0}\), &lt;code>NumPair&lt;/code>を定義した。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-lean" data-lang="lean">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#76a9f9">structure&lt;/span> &lt;span style="color:#aa89ea">NumPair&lt;/span> &lt;span style="color:#76a9f9">where&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">num&lt;/span>&lt;span style="color:#54b1c7">:&lt;/span> &lt;span style="color:#aa89ea">Int&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">denom&lt;/span>&lt;span style="color:#54b1c7">:&lt;/span> &lt;span style="color:#aa89ea">Nat&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">denom_non_zero&lt;/span>&lt;span style="color:#54b1c7">:&lt;/span> &lt;span style="color:#aa89ea">denom&lt;/span> &lt;span style="color:#e5c07b">≠&lt;/span> &lt;span style="color:#d19a66">0&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>ここでのポイントは、分母が0でないことを保証するために、&lt;code>denom_non_zero&lt;/code>という要素を&lt;code>NumPair&lt;/code>に追加している点である。&lt;/p>
&lt;p>次に、&lt;code>NumPair&lt;/code>に対して同値関係を定義した。これからこの関係を用いて有理数を定義するのだから、同値関係は以下のようになる。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-lean4" data-lang="lean4">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#76a9f9">fun&lt;/span> &lt;span style="color:#aa89ea">a&lt;/span> &lt;span style="color:#aa89ea">b&lt;/span> &lt;span style="color:#e5c07b">=&amp;gt;&lt;/span> &lt;span style="color:#aa89ea">a&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">num&lt;/span> &lt;span style="color:#e5c07b">*&lt;/span> &lt;span style="color:#aa89ea">b&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">denom&lt;/span> &lt;span style="color:#e5c07b">=&lt;/span> &lt;span style="color:#aa89ea">b&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">num&lt;/span> &lt;span style="color:#e5c07b">*&lt;/span> &lt;span style="color:#aa89ea">a&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">denom&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>さて、この同値関係を持ちいて同値類をとりたいわけだが、Lean4では同値類&lt;code>Quotient&lt;/code>をとるためには、数学でいうところの\((X, \sim)\)に相当する&lt;code>Setoid&lt;/code>のインスタンスを定義する必要がある。そして、この&lt;code>Setoid&lt;/code>のインスタンス定義には、ちゃんとこの2項関係が同値関係になっていることを示す必要がある。&lt;/p>
&lt;p>この&lt;code>Setoid&lt;/code>のインスタンス定義を行うと以下のようになる。&lt;code>r&lt;/code>の部分が同値関係の定義を、&lt;code>iseqv&lt;/code>の部分がそれがちゃんと同値関係になっていることの証明になっている。&lt;code>case refl&lt;/code>と書いてあるところが反射律を、&lt;code>case symm&lt;/code>が対称律を、&lt;code>case trans&lt;/code>が推移律を示している部分である。推移律に関しては、掛け算の交換法則や結合法則を駆使して証明しているので、そこまで特別なことをしていないのに証明が長くなっている。&lt;code>↑&lt;/code>はもちろんKnuthの矢印記法&amp;hellip;ではなく、&lt;code>Nat&lt;/code>を&lt;code>Int&lt;/code>に変換するための記号である。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-lean" data-lang="lean">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#76a9f9">instance&lt;/span> &lt;span style="color:#aa89ea">NumPairSetoid&lt;/span> &lt;span style="color:#54b1c7">:&lt;/span> &lt;span style="color:#aa89ea">Setoid&lt;/span> &lt;span style="color:#aa89ea">NumPair&lt;/span> &lt;span style="color:#76a9f9">where&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">r&lt;/span> &lt;span style="color:#54b1c7">:&lt;/span>&lt;span style="color:#e5c07b">=&lt;/span> &lt;span style="color:#76a9f9">fun&lt;/span> &lt;span style="color:#aa89ea">a&lt;/span> &lt;span style="color:#aa89ea">b&lt;/span> &lt;span style="color:#e5c07b">=&amp;gt;&lt;/span> &lt;span style="color:#aa89ea">a&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">num&lt;/span> &lt;span style="color:#e5c07b">*&lt;/span> &lt;span style="color:#aa89ea">b&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">denom&lt;/span> &lt;span style="color:#e5c07b">=&lt;/span> &lt;span style="color:#aa89ea">b&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">num&lt;/span> &lt;span style="color:#e5c07b">*&lt;/span> &lt;span style="color:#aa89ea">a&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">denom&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">iseqv&lt;/span> &lt;span style="color:#54b1c7">:&lt;/span>&lt;span style="color:#e5c07b">=&lt;/span> &lt;span style="color:#76a9f9">by&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">constructor&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">case&lt;/span> &lt;span style="color:#aa89ea">refl&lt;/span> &lt;span style="color:#e5c07b">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">intros&lt;/span> &lt;span style="color:#aa89ea">x&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">rfl&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">case&lt;/span> &lt;span style="color:#aa89ea">symm&lt;/span> &lt;span style="color:#e5c07b">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">intros&lt;/span> &lt;span style="color:#aa89ea">x&lt;/span> &lt;span style="color:#aa89ea">y&lt;/span> &lt;span style="color:#aa89ea">h&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">rw&lt;/span> &lt;span style="color:#54b1c7">[&lt;/span>&lt;span style="color:#aa89ea">Int&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">mul_comm&lt;/span>&lt;span style="color:#54b1c7">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">rw&lt;/span> &lt;span style="color:#54b1c7">[&lt;/span>&lt;span style="color:#aa89ea">h&lt;/span>&lt;span style="color:#54b1c7">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">rw&lt;/span> &lt;span style="color:#54b1c7">[&lt;/span>&lt;span style="color:#aa89ea">Int&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">mul_comm&lt;/span>&lt;span style="color:#54b1c7">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">case&lt;/span> &lt;span style="color:#aa89ea">trans&lt;/span> &lt;span style="color:#e5c07b">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">intros&lt;/span> &lt;span style="color:#aa89ea">x&lt;/span> &lt;span style="color:#aa89ea">y&lt;/span> &lt;span style="color:#aa89ea">z&lt;/span> &lt;span style="color:#aa89ea">h1&lt;/span> &lt;span style="color:#aa89ea">h2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#76a9f9">have&lt;/span> &lt;span style="color:#aa89ea">h1_mod&lt;/span>&lt;span style="color:#54b1c7">:&lt;/span> &lt;span style="color:#aa89ea">x&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">num&lt;/span> &lt;span style="color:#e5c07b">*&lt;/span> &lt;span style="color:#e5c07b">↑&lt;/span>&lt;span style="color:#aa89ea">y&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">denom&lt;/span> &lt;span style="color:#e5c07b">*&lt;/span> &lt;span style="color:#e5c07b">↑&lt;/span>&lt;span style="color:#aa89ea">z&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">denom&lt;/span> &lt;span style="color:#e5c07b">=&lt;/span> &lt;span style="color:#aa89ea">y&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">num&lt;/span> &lt;span style="color:#e5c07b">*&lt;/span> &lt;span style="color:#e5c07b">↑&lt;/span>&lt;span style="color:#aa89ea">x&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">denom&lt;/span> &lt;span style="color:#e5c07b">*&lt;/span> &lt;span style="color:#e5c07b">↑&lt;/span>&lt;span style="color:#aa89ea">z&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">denom&lt;/span> &lt;span style="color:#54b1c7">:&lt;/span>&lt;span style="color:#e5c07b">=&lt;/span> &lt;span style="color:#76a9f9">by&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">rw&lt;/span> &lt;span style="color:#54b1c7">[&lt;/span>&lt;span style="color:#aa89ea">h1&lt;/span>&lt;span style="color:#54b1c7">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#76a9f9">have&lt;/span> &lt;span style="color:#aa89ea">h2_mod&lt;/span>&lt;span style="color:#54b1c7">:&lt;/span> &lt;span style="color:#aa89ea">y&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">num&lt;/span> &lt;span style="color:#e5c07b">*&lt;/span> &lt;span style="color:#e5c07b">↑&lt;/span>&lt;span style="color:#aa89ea">z&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">denom&lt;/span> &lt;span style="color:#e5c07b">*&lt;/span> &lt;span style="color:#e5c07b">↑&lt;/span>&lt;span style="color:#aa89ea">x&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">denom&lt;/span> &lt;span style="color:#e5c07b">=&lt;/span> &lt;span style="color:#aa89ea">z&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">num&lt;/span> &lt;span style="color:#e5c07b">*&lt;/span> &lt;span style="color:#e5c07b">↑&lt;/span>&lt;span style="color:#aa89ea">y&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">denom&lt;/span> &lt;span style="color:#e5c07b">*&lt;/span> &lt;span style="color:#e5c07b">↑&lt;/span>&lt;span style="color:#aa89ea">x&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">denom&lt;/span> &lt;span style="color:#54b1c7">:&lt;/span>&lt;span style="color:#e5c07b">=&lt;/span> &lt;span style="color:#76a9f9">by&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">rw&lt;/span> &lt;span style="color:#54b1c7">[&lt;/span>&lt;span style="color:#aa89ea">h2&lt;/span>&lt;span style="color:#54b1c7">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#76a9f9">have&lt;/span>&lt;span style="color:#54b1c7">:&lt;/span> &lt;span style="color:#aa89ea">y&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">num&lt;/span> &lt;span style="color:#e5c07b">*&lt;/span> &lt;span style="color:#e5c07b">↑&lt;/span>&lt;span style="color:#aa89ea">x&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">denom&lt;/span> &lt;span style="color:#e5c07b">*&lt;/span> &lt;span style="color:#e5c07b">↑&lt;/span>&lt;span style="color:#aa89ea">z&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">denom&lt;/span> &lt;span style="color:#e5c07b">=&lt;/span> &lt;span style="color:#aa89ea">y&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">num&lt;/span> &lt;span style="color:#e5c07b">*&lt;/span> &lt;span style="color:#e5c07b">↑&lt;/span>&lt;span style="color:#aa89ea">z&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">denom&lt;/span> &lt;span style="color:#e5c07b">*&lt;/span> &lt;span style="color:#e5c07b">↑&lt;/span>&lt;span style="color:#aa89ea">x&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">denom&lt;/span> &lt;span style="color:#54b1c7">:&lt;/span>&lt;span style="color:#e5c07b">=&lt;/span> &lt;span style="color:#76a9f9">by&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">rw&lt;/span> &lt;span style="color:#54b1c7">[&lt;/span>&lt;span style="color:#aa89ea">Int&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">mul_assoc&lt;/span>&lt;span style="color:#54b1c7">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">rw&lt;/span> &lt;span style="color:#54b1c7">[&lt;/span>&lt;span style="color:#aa89ea">Int&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">mul_assoc&lt;/span>&lt;span style="color:#54b1c7">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">conv&lt;/span> &lt;span style="color:#e5c07b">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">lhs&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">conv&lt;/span> &lt;span style="color:#e5c07b">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">rhs&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">rw&lt;/span> &lt;span style="color:#54b1c7">[&lt;/span>&lt;span style="color:#aa89ea">Int&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">mul_comm&lt;/span>&lt;span style="color:#54b1c7">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#76a9f9">have&lt;/span>&lt;span style="color:#54b1c7">:&lt;/span> &lt;span style="color:#aa89ea">y&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">denom&lt;/span> &lt;span style="color:#e5c07b">*&lt;/span> &lt;span style="color:#54b1c7">(&lt;/span>&lt;span style="color:#aa89ea">x&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">num&lt;/span> &lt;span style="color:#e5c07b">*&lt;/span> &lt;span style="color:#e5c07b">↑&lt;/span>&lt;span style="color:#aa89ea">z&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">denom&lt;/span>&lt;span style="color:#54b1c7">)&lt;/span> &lt;span style="color:#e5c07b">=&lt;/span> &lt;span style="color:#aa89ea">y&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">denom&lt;/span> &lt;span style="color:#e5c07b">*&lt;/span> &lt;span style="color:#54b1c7">(&lt;/span>&lt;span style="color:#aa89ea">z&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">num&lt;/span> &lt;span style="color:#e5c07b">*&lt;/span> &lt;span style="color:#e5c07b">↑&lt;/span>&lt;span style="color:#aa89ea">x&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">denom&lt;/span>&lt;span style="color:#54b1c7">)&lt;/span> &lt;span style="color:#54b1c7">:&lt;/span>&lt;span style="color:#e5c07b">=&lt;/span> &lt;span style="color:#76a9f9">by&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">rw&lt;/span> &lt;span style="color:#54b1c7">[&lt;/span>&lt;span style="color:#e5c07b">←&lt;/span>&lt;span style="color:#aa89ea">h1_mod&lt;/span>&lt;span style="color:#54b1c7">]&lt;/span> &lt;span style="color:#76a9f9">at&lt;/span> &lt;span style="color:#aa89ea">this&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">rw&lt;/span> &lt;span style="color:#54b1c7">[&lt;/span>&lt;span style="color:#aa89ea">h2_mod&lt;/span>&lt;span style="color:#54b1c7">]&lt;/span> &lt;span style="color:#76a9f9">at&lt;/span> &lt;span style="color:#aa89ea">this&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">conv&lt;/span> &lt;span style="color:#76a9f9">at&lt;/span> &lt;span style="color:#aa89ea">this&lt;/span> &lt;span style="color:#e5c07b">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">lhs&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">conv&lt;/span> &lt;span style="color:#e5c07b">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">lhs&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">rw&lt;/span> &lt;span style="color:#54b1c7">[&lt;/span>&lt;span style="color:#aa89ea">Int&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">mul_comm&lt;/span>&lt;span style="color:#54b1c7">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">rw&lt;/span> &lt;span style="color:#54b1c7">[&lt;/span>&lt;span style="color:#aa89ea">Int&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">mul_assoc&lt;/span>&lt;span style="color:#54b1c7">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">conv&lt;/span> &lt;span style="color:#76a9f9">at&lt;/span> &lt;span style="color:#aa89ea">this&lt;/span> &lt;span style="color:#e5c07b">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">rhs&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">conv&lt;/span> &lt;span style="color:#e5c07b">=&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">lhs&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">rw&lt;/span> &lt;span style="color:#54b1c7">[&lt;/span>&lt;span style="color:#aa89ea">Int&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">mul_comm&lt;/span>&lt;span style="color:#54b1c7">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">rw&lt;/span> &lt;span style="color:#54b1c7">[&lt;/span>&lt;span style="color:#aa89ea">Int&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">mul_assoc&lt;/span>&lt;span style="color:#54b1c7">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">exact&lt;/span> &lt;span style="color:#aa89ea">this&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#76a9f9">have&lt;/span> &lt;span style="color:#aa89ea">y_denom_zero&lt;/span>&lt;span style="color:#54b1c7">:&lt;/span> &lt;span style="color:#54b1c7">(&lt;/span>&lt;span style="color:#e5c07b">↑&lt;/span>&lt;span style="color:#aa89ea">y&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">denom&lt;/span>&lt;span style="color:#54b1c7">:&lt;/span> &lt;span style="color:#aa89ea">Int&lt;/span>&lt;span style="color:#54b1c7">)&lt;/span> &lt;span style="color:#e5c07b">≠&lt;/span> &lt;span style="color:#d19a66">0&lt;/span> &lt;span style="color:#54b1c7">:&lt;/span>&lt;span style="color:#e5c07b">=&lt;/span> &lt;span style="color:#76a9f9">by&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">rw&lt;/span> &lt;span style="color:#54b1c7">[&lt;/span>&lt;span style="color:#aa89ea">Int&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">ofNat_ne_zero&lt;/span>&lt;span style="color:#54b1c7">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">exact&lt;/span> &lt;span style="color:#aa89ea">y&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">denom_non_zero&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">rw&lt;/span> &lt;span style="color:#54b1c7">[&lt;/span>&lt;span style="color:#aa89ea">Int&lt;/span>&lt;span style="color:#e5c07b">.&lt;/span>&lt;span style="color:#aa89ea">mul_eq_mul_left_iff&lt;/span> &lt;span style="color:#aa89ea">y_denom_zero&lt;/span>&lt;span style="color:#54b1c7">]&lt;/span> &lt;span style="color:#76a9f9">at&lt;/span> &lt;span style="color:#aa89ea">this&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#aa89ea">exact&lt;/span> &lt;span style="color:#aa89ea">this&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>正直この証明は長いだけである。&lt;/p></description></item><item><title>Lean4と戯れるのに役に立ったもの</title><link>https://caphosra.net/posts/2024-12-06-lean4-tips/</link><pubDate>Fri, 06 Dec 2024 07:51:57 +0900</pubDate><guid>https://caphosra.net/posts/2024-12-06-lean4-tips/</guid><description>&lt;p>この記事は, &lt;a href="https://adventar.org/calendars/10445" class="external-link" target="_blank" rel="noopener">理情 Advent Calendar 2024&lt;/a>の12/6の記事です. この文章を読むのに飽きたら是非他の人の書いた記事を読んでみてください.&lt;/p>
&lt;h2 id="はじめに">
 はじめに
 &lt;a class="heading-link" href="#%e3%81%af%e3%81%98%e3%82%81%e3%81%ab">
 &lt;i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク">&lt;/i>
 &lt;span class="sr-only">見出しへのリンク&lt;/span>
 &lt;/a>
&lt;/h2>
&lt;p>今年4月ごろに, 元から興味を持っていたプログラミング言語もとい定理証明支援系のLean4に満を持して入門しました.&lt;/p>
&lt;p>しかしながら, 単に情報がないからなのか自分の検索能力が低いからなのか, 普通に手元では証明できているのにLean4にどのように書き下せばいいのかわからない場面が何度もあったので, この記事では初心者なりにかなり便利でもっと早く知っておきたかったいくつかのトピックを, 少しでも証明を楽しむためのヒントとして記したいと思います. かなり雑多だと思うのですが, どうかお付き合いください.&lt;/p>
&lt;p>注意点として, Lean4の公式の &lt;a href="https://leanprover.github.io/theorem_proving_in_lean4/" class="external-link" target="_blank" rel="noopener">Theorem Proving in Lean 4&lt;/a> に載っている内容はこの記事では基本省略してあるので, 基本的な使い方を習得するのにはこの記事は向かないと思います.&lt;/p>
&lt;p>また, 直観論理の世界から抜け出したくない方には申し訳ないのですがこの記事では古典論理を前提としており, 断りなく&lt;code>open Classical&lt;/code>されていることを仮定しています.&lt;/p>
&lt;h2 id="1-lean-4-vscode-extension">
 1. Lean 4 VSCode Extension
 &lt;a class="heading-link" href="#1-lean-4-vscode-extension">
 &lt;i class="fa-solid fa-link" aria-hidden="true" title="見出しへのリンク">&lt;/i>
 &lt;span class="sr-only">見出しへのリンク&lt;/span>
 &lt;/a>
&lt;/h2>
&lt;p>かなり当たり前かもしれませんが, この拡張を入れるとLean4のsyntax highlightingや入力予測がされるようになります. それだけでなく, 現在の証明の流れがとても掴みやすくなるInfoViewが見れるようになります.&lt;/p>
&lt;p>&lt;img src="https://caphosra.net/images/2024-12-06/lean4_screenshot1.jpg" alt="Lean4 info view screenshot">&lt;/p>
&lt;p>左に書かれているのがLean4の証明で, 右がその様子をわかりやすく表示してくれるInfoViewです. 写真では119行目にカーソルが合っているので119行目における証明の進行状況が表示されています.&lt;/p>
&lt;p>&lt;img src="https://caphosra.net/images/2024-12-06/lean4_screenshot2.jpg" alt="Lean4 info view screenshot">&lt;/p>
&lt;p>このviewの見方をざっと解説します.&lt;/p>
&lt;p>まず, 画像でオレンジ色で表示されているのが, すでに導入された命題のリストです. 仮定として証明に使って良い名前付けされた命題が並んでいます. Curry-Howard同型対応と呼ばれる, ざっくりといえば関数と型はそれぞれ証明と命題に対応するという対応関係から, 現在のスコープにある変数とその型であるとみることもできます.&lt;/p>
&lt;p>次に画像で一番下に表示されているのが, この証明のゴール, つまり示すべきものです. このゴールは, 必ずしもある定理の証明をする間ずっと同じというわけでもなく, 場合分けの途中や補題の証明中などに変わることもあるので, 今自分が何を示そうとしているのか意識するためにも常に把握しておきましょう.&lt;/p></description></item></channel></rss>